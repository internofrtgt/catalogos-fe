# Railway Configuration
[build]
builder = "NIXPACKS"

[deploy]
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[[services]]
name = "backoffice-api"
source = "backoffice-api"

[services.build]
builder = "NIXPACKS"
buildCommand = "cd backoffice-api && npm install && npm run build"
startCommand = "cd backoffice-api && npm run start:prod"

[services.variables]
NODE_ENV = "production"
PORT = "3000"
TYPEORM_SYNCHRONIZE = "false"
TYPEORM_RUN_MIGRATIONS = "true"
TYPEORM_LOGGING = "error"
JWT_SECRET = "your-jwt-secret-change-this-in-production"
DEFAULT_ADMIN_USERNAME = "admin"
DEFAULT_ADMIN_PASSWORD = "ChangeMe123!"

# Database Configuration
[[services.databases]]
name = "backoffice-db"
databaseName = "backoffice"
user = "postgres"